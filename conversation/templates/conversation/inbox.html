{% extends 'app002/base.html' %}


{% block title %} Inbox {% endblock %}

{% block content %}


<div class="block lg:hidden">

     <div class="grid grid-cols-3 gap-0" style="grid-template-columns: 5% 90% 5%;">
         <div class="w-full"></div>
         <div class="w-full space-y-1 mb-2">
             {% for conversation in conversations %}
            <a href="{% url 'conversation:detail' conversation.id %}">
                <div class=" grid grid-cols-2 gap-0 px-1 py-1 my-2 bg-gray-400 rounded-r-lg rounded-l-2xl" style="grid-template-columns: 23% 77%;">
                    <div class="pr-1">
                        <img src="{{ conversation.item.image.url }}" class="w-full" style="border-radius: 50%;">
                    </div>
                    <div>
                      {% for member in conversation.members.all %}
                          {% if member != request.user %}

                              <div class="grid grid-cols-2 gap-0" style="grid-template-columns: 65% 35%;">
                                    <p class="text-sm">Chat <strong>{{ member.username }}</strong></p>

                                {% if messages_number != 0 %}
                                    <a href="{% url 'conversation:detail' conversation.id %}"
                                    class="text-white text-center mb-1 px-1 bg-black text-sm rounded-lg hover:bg-yellow-200 hover:text-black hover:cursor-pointer">Click</a>
                                {% else %}
                                    {% with messages=conversation.messages %}
                                    <a href="{% url 'conversation:detail' conversation.id %}"
                                    class="text-white text-center mb-1 px-1 bg-black text-sm rounded-lg hover:bg-yellow-200 hover:text-black hover:cursor-pointer"><strong class="text-green-500 p-1 text-sm">{{ messages.count }}</strong>Click</a>
                                    {% endwith %}
                                {% endif %}
                              </div>
                              <hr>
                              <div class="grid grid-cols-2 gap-0" style="grid-template-columns: 60% 40%;">
                                    <p class="text-black-500 text-left text-sm"><strong>{{ conversation.item.name }}</strong><br><i class="fa-solid fa-location-dot"></i>Butembo</p>
                                    <p class="text-sm text-right">Price: {{ conversation.item.price }}$.<br><i class="fa-regular fa-circle-xmark"></i>{{ conversation.modified_at|date:'d/m/y' }}</p>
                              </div>

                          {% endif %}
                      {% endfor %}
                    </div>
                </div>
            </a>
             {% endfor %}
         </div>
         <div class="w-full"></div>
     </div>

     <div class="grid grid-cols-5 gap-0 text-center text-white py-2 border rounded-lg bg-gray-200" style="grid-template-columns: 5% 90% 5%;">
        <p></p>
        <div class="bg-gray-500 text-center">
            <p>You have now <strong>{{ messages_number }}</strong> new messages.<br><hr></p>
            <p class="text-sm">You created <strong>{{ messages_number_created }}</strong> messages.<br><hr>You received <strong>{{ messages_number_received }}</strong> messages.</p><hr>
            <p class="text-sm">In total you have <strong>{{ conversations_number_all }}</strong> Chats.<br><hr>In total you have <strong>{{ messages_number_all }}</strong> messages.</p><hr>
        </div>
        <p></p>
     </div>
</div>

<!-----------------------------------  LG AND XL RESPONSIVE DESIGN------------------------------------->
<div class="hidden lg:block">
     <div class="grid grid-cols-3 gap-0 text-center text-white py-4 border rounded-xl bg-gray-500" style="grid-template-columns: 30% 30% 40%;">
        <p></p>
        <h1 class="mb-3 mt-3 text-2xl text-center">Inbox</h1>
        <p class="text-left"><strong>{{ conversations_number }}</strong> Conversations.<br><strong>{{ messages_number }}</strong> messages.</p>
     </div>
     <div class="grid grid-cols-3 gap-0" style="grid-template-columns: 25% 50% 25%;">
         <div class="w-full"></div>
         <div class="w-full space-y-6 mb-6">
             {% for conversation in conversations %}
              <a href="{% url 'conversation:detail' conversation.id %}">
                <div class=" grid grid-cols-2 gap-0 px-6 py-3 my-4 bg-gray-400 rounded-xl" style="grid-template-columns: 20% 80%;">
                    <div class="pr-6">
                        <img src="{{ conversation.item.image.url }}" class="w-full rounded-xl">
                    </div>
                    <div>
                      {% for member in conversation.members.all %}
                          {% if member != request.user %}
                              <div class="grid grid-cols-2 gap-0" style="grid-template-columns: 80% 20%;">
                                    <p>{{ request.user }}, <strong>{{ member.username }}</strong> likes your <strong>{{ conversation.item.name }}</strong><br>
                                    <a href="{% url 'conversation:delete_conversation' conversation.id %}">delete</a></p>
                                    <a href="{% url 'conversation:detail' conversation.id %}" class="text-white px-2 bg-yellow-700 text-center rounded-xl hover:bg-yellow-200 hover:text-black hover:cursor-pointer">Click me</a>
                              </div>
                              <hr>
                              <div class="grid grid-cols-2 gap-0" style="grid-template-columns: 50% 50%;">
                                  <div>
                                    <p>Category: {{ conversation.item.category }}.</p>
                                    <p class="text-black-500 text-left">{{ member.username }}'s address: <i class="fa-solid fa-location-dot"></i>Butembo</p>
                                  </div>
                                  <div class="text-right">
                                      <p>Price: {{ conversation.item.price }}$.</p>
                                      <p>{{ conversation.modified_at }}</p>
                                  </div>
                              </div>
                          {% endif %}
                      {% endfor %}
                    </div>
                </div>
              </a>
             {% endfor %}
         </div>
         <div class="w-full"></div>
     </div>
</div>
{% endblock %}